@page "/deletenote"
@using WebUI.Helpers
@using WebUI.Services;
@using global::Data.ViewModels;
@inject INoteService noteService;
@inject IJSRuntime JsRuntime;

<h2>Delete Note</h2>

<EditForm model="id" OnValidSubmit="@HandleValidSumbit">
    <div class="container">
        <div class="d-flex justify-content-center">
            <div class="col-xl-4 col-lg-5 col-md-8 col-sm-12">
                <div class="d-flex flex-column">
                    <label>Id</label>
                    <InputText id="id" @bind-Value="id"/>
                    <button type="submit" class="mt-3">Submit</button>
                </div>
            </div>
        </div>
    </div>
</EditForm>

@code {
    private string id = "";

    private async void HandleValidSumbit() 
    {
        Guid guid = GuidHelper.TryParse(id);

        if (guid != Guid.Empty)
        {
            var result = await noteService.Delete(Guid.Parse(id));
            
            if(result.IsSuccessStatusCode)
                await JsRuntime.InvokeVoidAsync("alert", "success");
            else
                await JsRuntime.InvokeVoidAsync("alert", "note with this id not found");
        }
        else
            await JsRuntime.InvokeVoidAsync("alert", "your id its not guid");
    }
}